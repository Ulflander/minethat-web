(function(b){var a,g,h,d,f=require("./lib/internet.js"),e=0;require("./conf.js").conf(function(c){console.log(c);a=c.logger;g=require("./lib/models.js");d=require("./lib/job.js");h=g.model("Source");setInterval(b.update,"local"===c.env?3E4:1E4);a.log("Aggregator started...");d.init(b.update)});b.submit=function(c,k){console.log(k);d.makeup({customerId:"2c7f9a",gateway:"API",status:"VOID",type:"FEED_URL",value:k.link[0],meta:{doc_description_quality:c.quality,doc_title:k.title[0],doc_published_date:k.date,
doc_description:k.desc[0],doc_source_name:c.name,doc_source_url:c.url,doc_source_feed_url:c.feed_url}},function(c){c&&a.error("Unable to publish job",c)})};b.aggregate=function(c,k){f.feed(c.feed_url,function(e,g){if(e)a.error("Unable to retrieve feed items",e);else{var d=g.items,f,h=0,p=d.length;for(f=0;f<p;f+=1)d[f].date>(c.last||0)&&(b.submit(c,d[f]),d[f].date>h&&(h=d[f].date));0<h&&(c.last=h);k(c)}})};b.check=function(c){b.aggregate(c,function(c){h.update({_id:c._id},{last:c.last},function(c,
k,e){c?a.error("Error updating source",c):0===k&&a.error("Error updating source: no item affected")})})};b.update=function(){h.find({},{},{skip:e,limit:5},function(c,k){if(c)a.error("Error querying db",c);else{var d,f=k.length;if(0===f)e=0;else for(e+=1,d=0;d<f;d+=1)b.check(k[d])}})}})(exports);(function(b){var a=process.env.ENV,g,h=require("fs"),d=require("tracer").console({format:["{{timestamp}} <{{title}}> {{message}}",{error:"{{timestamp}} <{{title}}> {{message}} (in {{file}}:{{line}})\nCall Stack:\n{{stack}}"}],transport:function(c){5===c.level?console.error(c.output):console.log(c.output)}}),f=!1,e={loaded:!1,logger:d,env:a};"string"!==typeof a&&(d.error('No environment variable "ENV(test|local|development|production)"'),process.exit(1));g=__dirname+"/../../../conf/conf."+a+".sh";
b.parseLine=function(c){0!==c.indexOf("#")&&0<c.indexOf("=")&&(c=c.split("="),e[c[0].trim()]=/^[0-9]+$/ig.test(c[1])?parseInt(c[1],10):c[1].trim())};b.parse=function(c){c=c.split("\n");var k,e=c.length;for(k=0;k<e;k+=1)b.parseLine(c[k])};b.read=function(c){f=!0;h.realpath(g,function(k,a){k&&(d.error("No way to solve path "+g,k),process.exit(1));d.log("Loading configuration at "+a);h.readFile(a,function(k,a){k&&(d.error("No way to load conf",k),process.exit(1));b.parse(a.toString());h.realpath(__dirname+
"/../../",function(k,a){k&&(d.error("No way to get root path",k),process.exit(1));e.root=a;f=!1;e.loaded=!0;d.log("Configuration loaded ...");"function"===typeof c&&c(e)})})});return e};b.wait=function(c){setTimeout(function(){e.loaded?c(e):b.wait(c)},15)};b.conf=function(c){if(e.loaded)return"function"===typeof c&&c(e),e;if(!f)return b.read(c);"function"===typeof c&&b.wait(c);return e}})(exports);(function(){require("./conf.js").conf(function(b){require("./server.js").run(b)})})();(function(b){var a=require("connect"),g=require("serve-static"),h=require("body-parser"),d=require("./lib/blog.js"),f=require("./lib/init.js").initialize,e=require("./routes/router.js").router,c=require("./lib/job.js"),k=require("./controllers/404.js");b.run=function(b){var l=a();l.conf=b;l.logger=b.logger;c.init();d.init(function(){l.use(require("./lib/auth.js").auth);l.use(g(b.WEB_SERVER_STATIC_PATH||__dirname+"/../../dist"));l.use(h({limit:"10mb"}));l.use(f);l.use(e());l.use(k.index);l.listen(b.WEB_SERVER_PORT);
l.logger.log("Server started on "+b.WEB_SERVER_HOST+":"+b.WEB_SERVER_PORT)})}})(exports);(function(b){var a=require("../lib/controller-view.js"),g=require("../routes/routes.js").routes;b.index=function(b,d,f){b.logger.warn("Page not found: ["+b.method+"] "+b.url);console.log(g);a.view(b,d,"404.html",{value:1E3,url:null},404)}})(exports);(function(){var b=require("../lib/controller-view.js"),a=/<p>([^<]+)/im,g={},h={};exports.add=function(b,f){g[b]=f;var e=a.exec(f);h[b]=e?e[1].split("\n").join(" "):""};exports.index=function(a,f,e){e=[];var c,k;for(c in g)g.hasOwnProperty(c)&&(k=c.split("/devlog/").join("").split(".html").join("").split("-"),e.unshift({url:"/devlog/"+k.join("-")+".html",date:k.splice(0,3).join("/"),title:k.join(" ")}));b.view(a,f,"blog/articles.html",{articles:e})};exports.article=function(a,f,e){e=a.url.split("/devlog/").join("").split(".html").join("").split("-");
b.view(a,f,"blog/article.html",{summary:h[a.url],url:"http://www.minethat.co"+a.url,content:g[a.url]||"Article not found",date:e.splice(0,3).join("/"),title:e.join(" ")})}})();(function(){var b=require("../lib/controller-view.js");exports.index=function(a,g,h){b.findAll(a,g,"Document",null,null,{sort:{"properties.meta.doc_aggregated_date":-1},limit:50},"document/list.html")};exports.display=function(a,g,h){b.find(a,g,"Document","document/display.html")};exports.remove=function(a,g,h){b.remove(a,g,"Document")};exports.search=function(a,g,h){b.findAll(a,g,"Document",null,null,{sort:{"properties.meta.doc_aggregated_date":-1}},"document/search.html")}})();(function(){var b=require("../lib/controller-view.js"),a=require("../lib/valid.js"),g=require("../lib/mail.js"),h=require("url"),d=require("ua-parser-js"),f=require("../routes/campaigns.js").campaigns;exports.campaign=function(a){var c={ref_campaign:"None",ref_domain:"Unknown"};a.query&&a.query.r&&(c.ref_campaign=f[a.query.r]||a.query.r);a.headers.referer&&(c.ref_domain=h.parse(a.headers.referer).hostname,0===c.ref_domain.indexOf("www.")&&(c.ref_domain=c.ref_domain.substr(4)));return c};exports.index=
function(a,c,k){b.view(a,c,"landing/landing.html",exports.campaign(a))};exports.subscribe=function(b,c,k){k=b.model("Subscriber");if(!b.body||!b.body.email)return c.json({error:"miss_param"},500);if(!a.email(b.body.email))return c.json({error:"invalid_email"},500);k.findOne({email:b.body.email},function(k,a){if(k)return c.json({error:"db_check_failed"},500);if(a)return c.json({status:"exists",id:a._id},200);exports.create(b,c)})};exports.create=function(a,c){var k=a.model("Subscriber"),b=(new d).setUA(a.headers["user-agent"]).getResult()||
{},f=new k({email:a.body.email,ref_campaign:a.body.ref_campaign,ref_domain:a.body.ref_domain,browser:b.browser&&b.browser.name?b.browser.name:"Unknown",os:b.os&&b.os.name?b.os.name:"Unknown",device:b.device&&b.device.vendor?b.device.vendor+" / "+(b.device.model||"Unknown"):"Unknown"});f.save(function(b){if(b)return c.json({error:"db_save_failed"},500);g.template(a.body.email,"You're in!","landing-subscribed.html",{sub:f});g.template("xav@minethat.co","He's in!","landing-subscribed-alert.html",{sub:f});
c.json({status:"success"})})}})();(function(){var b=require("../lib/controller-view.js");exports.index=function(a,g,h){b.findAll(a,g,"Job",null,null,null,"job/list.html")};exports.remove=function(a,g,h){b.remove(a,g,"Job")}})();(function(){var b=require("../lib/controller-view.js"),a=require("../lib/internet.js");exports.index=function(a,h,d){b.findAll(a,h,"Source",null,null,null,"source/list.html")};exports.display=function(a,h,d){b.find(a,h,"Source","source/edit.html")};exports.from_feed=function(g,h,d){"GET"===g.method?b.view(g,h,"source/from_feed.html"):a.feed(g.body.feed_url,function(a,e){a||!e?b.view(g,h,"source/from_feed.html",{error:"Invalid feed"}):(g.body.name=e.metadata.title,g.body.url=e.metadata.url,exports.add(g,
h,d))})};exports.add=function(a,h,d){b.create(a,h,"Source","source/edit.html","/app/source/:id")};exports.edit=function(a,h,d){b.edit(a,h,"Source","source/edit.html")};exports.check=function(b,h,d){a.feed(b.body.feed_url,function(a,d){a||!d?h.json({status:"error",error:"Invalid feed"},422):b.findAll(b,"Source",{feed_url:b.body.feed_url},null,null,function(c,a){c?h.json({status:"error",error:"Internal error"},500):(console.log(a),0===a.total?h.json({status:"success"},200):h.json({status:"exists"},
409))})})};exports.remove=function(a,h,d){b.remove(a,h,"Source")}})();(function(){var b=require("../lib/job.js");exports.html_string=function(a,b,h){if(!a.body.content)return b.json({status:"error",error:'Missing "content" parameter'},500);exports.submit(a,b,"HTML_STRING",a.body.content)};exports.string=function(a,b,h){if(!a.body||!a.body.string)return b.json({status:"error",error:'Missing "string" parameter'},500);exports.submit(a,b,"STRING",a.body.string)};exports.url=function(a,b,h){if(!a.body||!a.body.url)return b.json({status:"error",error:'Missing "url" parameter'},
500);exports.submit(a,b,"URL",a.body.url)};exports.submit=function(a,g,h,d){console.log("[API] Got request");var f={customerId:"2c7f9a",gateway:"API",status:"VOID",type:h,value:d};a.body.meta&&(f.meta=a.body.meta);if(a.body.target&&"TRAIN"===a.body.target){if(!a.body||!a.body.classes)return g.json({status:"error",error:'Missing "classes" parameter'},500);f.target="TRAIN";f.classes=a.body.classes}b.makeup(f,function(a){return a?g.json({status:"error",error:"DB error"},500):g.json({status:"success",
job:f._id})})}})();(function(){var b=require("../lib/controller-view.js");exports.index=function(a,g,h){b.findAll(a,g,"Subscriber",null,null,null,"subscriber/list.html")};exports.display=function(a,g,h){b.find(a,g,"Subscriber","subscriber/display.html")};exports.csv=function(a,g,h){b.find(a,g,"Subscriber","subscriber/display.html")}})();(function(){var b=require("../lib/controller-view.js");exports.index=function(a,g){var h=a.model("Subscriber");if(!a.query.id)return g.error("Missing param for unsubscription",500);h.findById(a.query.id,function(d,f){var e=null;if(d)return g.error("DB query error",500);a.query.action&&("unsubscribe"===a.query.action?(f.unactivated=!0,e="Done! You won't receive our newsletter anymore."):(f.unactivated=!1,e="Thanks! You're now subscribed to our newsletter!"),f.save());b.view(a,g,"subscriber/subscription.html",
{msg:e,sub:f})})}})();(function(){var b=require("http-auth").basic({authRealm:"Private Minethat",file:__dirname+"/../../../users.htpasswd"});exports.auth=function(a,g,h){0===a._parsedUrl.href.indexOf("/private")||0===a._parsedUrl.href.indexOf("/admin")||0===a._parsedUrl.href.indexOf("/app")?b.check(a,g,function(a){h()}):h()}})();(function(){var b=require("fs"),a=require("../routes/routes.js"),g=require("../controllers/blog.js"),h=require("marked"),d=require("../conf.js").conf();exports.add=function(f){if("."!==f.substring(0,1)||"local"===d.env){var e=f.split(".md").join("");a.add("/devlog/"+e+".html",["get","blog.article"]);b.readFile(d.root+"/src/blog/"+f,function(c,a){c?d.logger.error("Unable to read blog article"+d.root+"/src/blog/"+f,c):h(a.toString(),{},function(c,a){c?d.logger.error("Unable to convert blog article"+
d.root+"/src/blog/"+f,c):g.add("/devlog/"+e+".html",a)})})}};exports.init=function(a){b.readdir(d.root+"/src/blog/",function(b,c){if(b)d.logger.error('Blog files not found at "'+d.root+'/src/blog/"',b);else{var k,g=c.length;for(k=0;k<g;k+=1)-1<c[k].indexOf(".md")&&exports.add(c[k]);"function"===typeof a&&a()}})}})();(function(){var b=require("ejs"),a=require("fs"),g=require("async"),h=require("../conf.js").conf(),d=/<%-\s+partial\s*\(\s*['"]([a-zA-Z0-9\\\-_]+)['"]/ig,f={},e={leadingZero:function(c){return 10>c?"0"+c:c},tsToReadable:function(c){c=new Date(c);return c.getMonth()+1+"/"+c.getDate()+"/"+c.getUTCFullYear()+", "+e.leadingZero(c.getHours())+":"+e.leadingZero(c.getMinutes())}};exports.remove=function(c,a,b,f){c.isAPI?c.model(b).findById(c.params.id,function(c,b){c||null===b?a.json({status:"error",error:"Resource not found"},
404):b.remove(function(c){c?a.json({status:"error",error:"Resource not deleted"},500):a.json({status:"success"},200)})}):a.error(404,"Only available through API")};exports.save=function(c,a,b,f,d){var e=new (c.model(b))(c.body),g=!1;e.save(function(b){var h={status:b?"success":"error",doc:e.toObject()};g||(g=!0,b&&(h.error={message:b}),c.isAPI?a.json(h,b?500:200):d?a.redirect(d.split(":id").join(e._id)):exports.view(c,a,f,h))})};exports.create=function(c,a,b,f,d){var e=c.model(b);"POST"===c.method?
exports.save(c,a,b,f,d):c.isAPI?a.json({error:"Not implemented"},500):exports.view(c,a,f,{doc:new e,status:"create"})};exports.find=function(c,a,b,f){c.find(b,c.params.id,function(b,d){if(b)return a.error(500);d?(console.log(d.toObject()),c.isAPI?a.json(d.toObject()):exports.view(c,a,f,{doc:d,status:"exists"})):c.isAPI?a.json({status:"error",error:"Resource not found"},404):a.error(404)})};exports.edit=function(c,a,b,d){"GET"===c.method?exports.find(c,a,b,d):c.model(b).update({_id:c.params.id},c.body,
function(f,e,g){if(f)return a.error(500);c.find(b,c.params.id,function(b,f){if(b)return a.error(500);f?c.isAPI?a.json(f):exports.view(c,a,d,{doc:f,status:"exists"}):c.isAPI?a.json({status:"error",error:"Resource not found"},404):a.error(404)})})};exports.findAll=function(a,b,f,d,e,g,h){a.findAll(a,f,d,e,g,function(f,d){if(f)return b.error(404);a.isAPI?b.json(d):exports.view(a,b,h,d)})};exports.requiresLoading=function(a){return!f[a]||"local"===h.env};exports.load=function(c,b){a.readFile(__dirname+
"/../views/"+c,function(a,d){a?(h.logger.error("File not found: views/"+c),f[c]="Template not found"):f[c]=d.toString();var e=exports.detectPartials(c);0<e.length?exports.loadPartials(e,b):"function"===typeof b&&b()})};exports.render=function(a,d){try{return b.render(f[a],{data:d?d:{},partial:exports.partial,env:h.env,utils:e})}catch(g){return h.logger.error("Unable to render template",g),null}};exports.view=function(a,b,d,f,e){exports.renderView(d,f,function(a){b.html(a,e)})};exports.renderView=
function(a,b,d){var f=function(){d(exports.render(a,b))};if(exports.requiresLoading(a))return exports.load(a,f);f()};exports.partial=function(a,d){var g={data:d};g.env=h.env;g.partial=exports.partial;g.utils=e;return b.render(f["_partials/"+a+".html"],g)};exports.loadPartials=function(a,b){var d,f=a.length,e=[];for(d=0;d<f;d+=1)e.push(exports.loadPartial(a[d]));g.parallel(e,b)};exports.loadPartial=function(a){return function(b){exports.load("_partials/"+a+".html",b)}};exports.detectPartials=function(a){for(var b=
[],e;;){e=d.exec(f[a]);if(!e)break;b.push(e[1])}return b}})();(function(b){var a=require("../conf.js").conf(),g=require("./respond.js"),h=require("./models.js"),d=require("qs");b.initialize=function(b,e,c){var k;b.logger=a.logger;b.query=d.parse(b._parsedUrl.query);for(k in h)h.hasOwnProperty(k)&&(b[k]?a.logger.error("Injection failed: key "+k+"already defined in Request object"):b[k]=h[k]);for(k in g)g.hasOwnProperty(k)&&(e[k]?a.logger.error("Injection failed: key "+k+"already defined in Response object"):e[k]=g[k]);c()}})(exports);(function(b){var a=require("request"),g=require("../conf.js").conf().logger,h=require("blindparser");b.get=function(b,f){try{a(b,function(a,e){a||200!==e.statusCode?(g.warn("URL "+b+"is invalid: "+a),f(a)):f(null,e.body,e.href)})}catch(e){g.warn("URL "+b+"is invalid",e),f(e)}};b.feed=function(a,f){b.get(a,function(a,b,d){if(a)f(a);else try{h.parseString(b,{},function(a,b){a?(g.warn("URL "+d+" feed is invalid: "+a),f(a)):f(null,b,d)})}catch(m){f(m)}})}})(exports);(function(){var b=require("amqp"),a=require("../conf.js").conf(),g=!1,h=require("./models.js"),d;exports.init=function(f){d=b.createConnection({host:a.RABBIT_HOST,port:a.RABBIT_PORT});d.on("ready",function(){a.logger.log("[RabbitMQ] Connection established");d.queue(a.RABBIT_EXTRACT_QUEUE,{durable:!0,exclusive:!1,autoDelete:!1},function(a){console.log("[RabbitMQ] Queue declared");g=!0;"function"===typeof f&&(f(),f=null)})});d.on("error",function(){g=!1;console.log("[RabbitMQ] Error",arguments)})};
exports.makeup=function(a,b){var c=new (h.model("Job"))(a);c.save(function(a){a||exports.publish(c._id);"function"===typeof b&&b(a,c)})};exports.publish=function(b){g?(a.logger.log("[RabbitMQ] Submitted job "+b),d.publish("extract",b)):setTimeout(function(){exports.publish(b)},100)}})();(function(){module.exports=function(b,a){if(b===a)return 0;var g=b.length,h=a.length,d=0,f=0,e,c,k,m,l=[];if(g&&h){for(;d<g;)d+=1,l[d]=d;for(;f<h;)for(m=a.charCodeAt(f),e=f,c=f+=1,d=0;d<g;d+=1)k=e+(b.charCodeAt(d)===m?0:1),e=l[d],c=c<e?c<k?c+1:k:e<k?e+1:k,l[d]=c;return c}return g+h}})();(function(){var b,a=require("html-to-text"),g=require("./controller-view.js"),h=require("../conf.js").conf(),d=h.logger,f=require("nodemailer");exports.html=function(e,c,g,m,l){b||(b=f.createTransport("SMTP",{service:"Gmail",auth:{user:h.WEB_EMAIL_USER,pass:h.WEB_EMAIL_PASS}}));d.debug("Sending message to: "+e+" (Subject: "+c+")");b.sendMail({from:m||"Xav from Minethat <xav@minethat.co>",to:e,subject:c,text:l||a.fromString(g),html:g},function(a,b){a?d.error(a):d.debug("Message sent to "+e+"/"+b.message)})};
exports.template=function(a,b,d,f,h,n){g.renderView("emails/"+d,f,function(d){exports.html(a,b,d,h,n)})}})();(function(){var b={},a=require("../conf.js").conf(),g=a.logger,h=require("mongoose"),a="mongodb://"+a.MONGO_HOST+":"+a.MONGO_PORT+"/"+a.MONGO_DB_PREFIX+a.env.toLowerCase();h.connect(a);g.info("Connecting to mongo on "+a);exports.loadModel=function(a){b[a]=require("../models/"+a.toLowerCase()+".js").define(h)};exports.model=function(a){b[a]||exports.loadModel(a);return b[a]};exports.find=function(a,b,e){"string"===typeof a&&(a=exports.model(a));a.findById(b,function(a,b){a&&g.error("Error querying db",
a);"function"===typeof e&&e(a,b)})};exports.findAll=function(a,b,e,c,h,m){var l=a.query?parseInt(a.query.page,10)||1:1,n=h?h.limit||20:20;"string"===typeof b&&(b=exports.model(b));b.count(e||{},function(a,d){a&&g.error("Error querying db",a);b.find(e||{},c||{},exports.page(l,h),function(a,b){a&&g.error("Error querying db",a);"function"===typeof m&&m(a,{docs:b,total:d,limit:n,page:l,hasNext:n*l<d,hasPrevious:1<l})})})};exports.page=function(a,b){var e,c;e=b?b.limit||20:20;e={skip:e*(a-1),limit:e};
if(b)for(c in b)b.hasOwnProperty(c)&&(e[c]=b[c]);return e}})();(function(){exports.error=function(b){this.respond(b||404,"text/plain","File not found")};exports.html=function(b,a){this.respond(a||200,"text/html",b)};exports.plain=function(b,a){this.respond(a||200,"text/plain",b)};exports.json=function(b,a){this.respond(a||200,"application/json","string"===typeof b?b:JSON.stringify(b))};exports.respond=function(b,a,g){this.writeHead(b,{"Content-type":a});this.end(g)};exports.redirect=function(b){this.writeHead(302,{Location:b});this.end()}})();(function(){exports.email=function(b){var a,g;if(!b||"string"!==typeof b)return!1;a=b.indexOf("@");g=b.lastIndexOf(".");return 0<a&&3<g&&a<g&&b.length>g+2}})();(function(){exports.define=function(b){return b.model("Document",new b.Schema({rawLength:Number,raw:String}))}})();(function(){exports.define=function(b){return b.model("Job",new b.Schema({start:{type:Date,"default":Date.now},end:Date,status:String,gateway:String,value:String,type:String,document:String,customerId:{type:String,index:!0},meta:{doc_title:String,doc_published_date:Number,doc_description:String,doc_source_name:String,doc_source_url:String,doc_source_feed_url:String,doc_description_quality:String},email:String,target:{type:String,"default":"MINE"},classes:String}))}})();(function(){var b=require("../lib/internet.js");exports.define=function(a){var g=new a.Schema({name:String,url:String,feed_url:{type:String,index:!0},type:{type:String,"default":"CONTENT"},quality:{type:String,"default":"NORMAL"},customer_id:{type:String,index:!0},last:{type:Number},fake:{type:Boolean,"default":!1}});a=a.model("Source",g);g.pre("save",function(a){var d=this,f=!1,e=0,c=function(b){b&&(f=!0);e+=1;2===e&&a(f?Error("Validation error"):null)};b.get(this.url,function(a,b,e){a&&d.invalidate("url",
"URL is invalid");c(a)});b.feed(this.feed_url,function(a,b,e){a&&d.invalidate("url","Feed URL is invalid");c(a)})});return a}})();(function(){exports.define=function(b){return b.model("Subscriber",new b.Schema({email:String,ref_campaign:String,ref_domain:String,os:String,device:String,browser:String,ts_created:{type:Date,"default":Date.now},unactivated:{type:Boolean,"default":!1}}))}})();(function(){exports.campaigns={b:"Blog",r1:"Reddit landing feedback",r2:"Reddit marketing campaign",t1:"Twitter Minethat link",t2:"Twitter xav link",c1:"First marketing campaign",e1:"Xav email footer",e2:"Minethat email footer",e3:"Newsletters"}})();(function(){var b=require("./routes.js").routes,a={},g=require("urlrouter");exports.setup=function(a,b,f,e,c){if("function"!==typeof e[c])throw Error('Route "'+f+'" is invalid:  function "'+c+'" does not exist in controller.');a[b](f,function(a,b,d){0===f.indexOf("/api")?a.isAPI=!0:a.isAPI=!1;e[c](a,b,d)})};exports.route=function(b,d,f){var e=f[1].split(".");a[e[0]]||(a[e[0]]=require("../controllers/"+e[0]+".js"));2>e.length&&(e[1]="index");exports.setup(b,f[0],d,a[e[0]],e[1])};exports.apply=function(a){var d,
f,e;for(d in b)if(b.hasOwnProperty(d))if("string"===typeof b[d][0])exports.route(a,d,b[d]);else for(f=0,e=b[d].length;f<e;f+=1)exports.route(a,d,b[d][f])};exports.router=function(){return g(exports.apply)}})();(function(){exports.add=function(b,a){exports.routes[b]=a};exports.routes={"/app/sources":["get","source.index"],"/app/source/new":[["get","source.add"],["post","source.add"]],"/app/source/generate":[["get","source.from_feed"],["post","source.from_feed"]],"/app/source/:id":[["get","source.edit"],["post","source.edit"]],"/app/documents":["get","document.index"],"/app/doc/:id":["get","document.display"],"/app/docs":["get","document.search"],"/app/jobs":["get","job.index"],"/admin/subscribers":["get",
"subscriber"],"/admin/subscribers.csv":["get","subscriber.csv"],"/admin/subscriber/:id":["get","subscriber.display"],"/api/v1/sources":["get","source.index"],"/api/v1/sources/check":["post","source.check"],"/api/v1/source/:id":[["get","source.display"],["post","source.edit"],["delete","source.remove"]],"/api/v1/source":["post","source.add"],"/api/v1/document/:id":[["get","document.display"],["delete","document.remove"]],"/api/v1/job/:id":["delete","job.remove"],"/api/v1/submit/url":["post","submit.url"],
"/api/v1/submit/string":["post","submit.string"],"/api/v1/submit/html_string":["post","submit.html_string"],"/":["get","home"],"/devlog":["get","blog"],"/ajax/landing_subscribe":["post","home.subscribe"],"/subscription":["get","subscription"]}})();
